<!DOCTYPE html>

<html>
<head>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,400;1,200&display=swap" rel="stylesheet">
  <link href="https://rsms.me/inter/inter.css" rel="stylesheet">
  <link rel="stylesheet" href="css-main/cssmainwebsite.css">
  <link rel="stylesheet" href="css-main/CT_LT-Main.css">
  <link rel="stylesheet" href="css-main/CT_LT-View-Edit.css">
  <link rel="icon" href="images/icon.png">
  <script src="../js-main/search.js"></script>
  <title>tinkerlab.</title>
</head>

<body>
  <div class="header">
    <img class="imglogo" src="images/tinkerlablogo.png">
  </div>
  <div class="taskbar">
    <div class="btndivider">
        <button class="btndesign" id="homebtn" disabled>Home</button>
    </div>
    <div class="btndivider">
      <a href="/Andrew">
        <button class="btndesign" id="reservationbtn" disabled>Reservation</button>
      </a>
    </div>
    <div class="btndivider">
        <button class="btndesign" id="vieweditbtn" disabled>View/Edit</button>
    </div>
    <div class="btndivider">
        <button class="btndesign" id="profilebtn" disabled>Profile</button>
    </div>
           <form id="searchForm" action="/search" method="GET" autocomplete="off">
            <div class="searchdivider">
                <div class="searchfield">
                    <input class="searchinput" type="text" name="name" placeholder="Search..." required>
                    <button class="searchbutton" type="submit">
                        <img src="images/searchglass.png" class="imgbtn" alt="Search">
                    </button>
                </div>
                <div class="suggestions-div">
                    <div class="suggestion-card">
                        <!--  a href cards of users will be inserted here -->
                    </div>
                </div>
            </div>
        </form>
  </div>

     <div class="lab-button">
            <p class="sort-text">COMPUTER LAB:</p>
            <div class="custom-select-wrapper">
                <select id="lab-dropdown" class="lab-dropdown">
                    <option value="GK101">GK101</option>
                    <option value="AG101">AG101</option>
                    <option value="VL101">VL101</option>
                </select>
            </div>
        </div>

        <div class="time-button">
            <p class="sort-text">TIME:</p>
            <div class="custom-select-wrapper">
                <select id="time-dropdown" class="time-dropdown" name="time">
                    <option class="choices" value="7:30AM-8:00AM">7:30AM - 8:00AM</option>
                    <option class="choices" value="8:00AM-8:30AM">8:00AM - 8:30AM</option>
                    <option class="choices" value="8:30AM-9:00AM">8:30AM - 9:00AM</option>
                    <option class="choices" value="9:00AM-9:30AM">9:00AM - 9:30AM</option>
                    <option class="choices" value="9:30AM-10:00AM">9:30AM - 10:00AM</option>
                    <option class="choices" value="10:00AM-10:30AM">10:00AM - 10:30AM</option>
                    <option class="choices" value="10:30AM-11:00AM">10:30AM - 11:00AM</option>
                    <option class="choices" value="11:00AM-11:30AM">11:00AM - 11:30AM</option>
                    <option class="choices" value="11:30AM-12:00PM">11:30AM - 12:00PM</option>
                    <option class="choices" value="12:00PM-12:30PM">12:00PM - 12:30PM</option>
                    <option class="choices" value="">----</option>
                </select>
            </div>
        </div>

        <script src="js-main/CT-Reservation_DateRestrict.js"></script>
        <div class="date-button">
            <p class="sort-text">DATE:</p>
            <form id="dateForm" action="/Velasco" method="GET">
                <input type="date" class="date-input" id="dateInput" name="date">
                <!-- Hidden input to store selected time -->
                <input type="hidden" id="selectedTime" name="time">
            </form>
        </div>
    </div>

    <div class="tablediv">
        <table>
            <thead>
                <tr>
                    <th>Computer Lab</th>
                    <th>Time</th>
                    <th>Date</th>
                    <th>Available Seats</th>
                    <th> </th>
                </tr>
            </thead>
            <tbody>
                {{#each data}}
                <tr>
                    <td>{{this.dblab}}</td> <!-- This is static; consider changing it dynamically if needed -->
                    <td>{{this.time}}</td>
                    <td>{{this.date}}</td>
                    <td>{{this.availableSeats}}</td>
                    <td>
                        <!--<button class="go-button"><a href="/Velasco">Go</a></button>-->
                    </td>
                </tr>
                {{/each}}
            </tbody>
        </table>
    </div>
    <div class="button-container">
        <button class="purple-button" id="search-button">Search</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const searchButton = document.getElementById('search-button');
            const labDropdown = document.getElementById('lab-dropdown');
            const dateInput = document.getElementById('dateInput');
            const timeDropdown = document.getElementById('time-dropdown');

            searchButton.addEventListener('click', async function () {
                const selectedLab = labDropdown.value;
                const dateofreservation = dateInput.value;
                const timeofreservation = timeDropdown.value;

                let lab, dblab;

                switch (selectedLab) {
                    case "GK101":
                        lab = "GK101";
                        dblab = "Goks";
                        break;
                    case "AG101":
                        lab = "AG101";
                        dblab = "Andrews";
                        break;
                    case "VL101":
                        lab = "VL101";
                        dblab = "Velascos";
                        break;
                    default:
                        alert('Please select a valid lab.');
                        return;
                }

                const searchData = {
                    lab,
                    dblab,
                    dateofreservation,
                    timeofreservation
                };

                console.log("Search Data:", searchData);

                try {
                    const response = await fetch('/VgetSearch', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(searchData)
                    });

                    if (response.ok) {
                        const result = await response.json();
                        // Redirect based on the response URL
                        window.location.href = result.redirectUrl;
                    } else {
                        const errorMessage = await response.text();
                        alert('An error occurred: ' + errorMessage);
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('An error occurred. Please try again later.');
                }
            });
        });
    </script>
  </div>
  <div class="button-container">
    <button class="purple-button"><a href="/">Return to Login Page</a></button>
  </div>

  <!--  Filter script -->
  <script src="../js-main/filter.js"></script>
 

  <!-- Hidden confirmation dialog -->
  <script src="js/prompt.js"></script>
  <div id="dialog-1" class="dialog-1">
    <div class="dialog-header"></div>
    <p class="prompt-text">DO YOU CONFIRM TO <br>CANCEL RESERVATION?</p>
    <div class="button-container">
      <button class="back-button" onclick="hidePrompt()">Back</button>
      <button class="purple-button" onclick="cancelReservation()">Confirm</button>
    </div>
  </div>
</body>
<footer>
  <div class="footer-container">
    <div class="footer-column-1">
      <img class="footer-logo" src="images/tinkerlablogo.png">
      <p><span class="tagline">Reserve in a Blink, then Explore and Think!</span></p>
    </div>
    <div class="footer-column-2">
      <h3>About</h3>
      <p class="footer-about">an intuitive platform that allows students to easily<br>
        reserve, check availability, and manage their computer<br>
        lab seats, ensuring hassle-free access for projects,<br>studying, and creative work.</p>
    </div>
    <div class="footer-column-3">
      <h3>Contact</h3>
      <div class="contact-info">
        <img class="email-logo" src="images/email-logo.png">
        <a class="dlsu-email" href="mailto:charlemagne_craw@dlsu.edu.ph">charlemagne_craw@dlsu.edu.ph</a>
      </div>
      <div class="contact-info">
        <img class="email-logo" src="images/email-logo.png">
        <a class="dlsu-email" href="mailto:rafael_debelen@dlsu.edu.ph">rafael_debelen@dlsu.edu.ph</a>
      </div>
      <div class="contact-info">
        <img class="email-logo" src="images/email-logo.png">
        <a class="dlsu-email" href="mailto:monica_santiago@dlsu.edu.ph">monica_santiago@dlsu.edu.ph</a>
      </div>
      <div class="contact-info">
        <img class="email-logo" src="images/email-logo.png">
        <a class="dlsu-email" href="mailto:john_fredrick_tario@dlsu.edu.ph">john_fredrick_tario@dlsu.edu.ph</a>
      </div>
    </div>
  </div>

  <script>
        const disabledButtons=document.querySelectorAll(".btndesign[disabled]");
        disabledButtons.forEach(button=>{
            button.classList.add('btndesign-disabled');
            button.style.background='#A359A0';
        });

        const disabledSearch=document.querySelectorAll(".searchinput[disabled]");
        disabledSearch.forEach(text=>{
            text.classList.add('disabled-searchinput');
        });

        /*const disabledSearchField=document.querySelectorAll(".searchfield[disabled]");
        disabledSearchField.forEach(searchField=>{
            searchField.style.background='#292929';
            searchInput.style.background='#292929';
        });*/
        
        const goGeneral = document.querySelectorAll('.go-button');
/*
        function leadToLogin(event){
            const warning = window.confirm('WARNING. YOU MUST LOG-IN FIRST.');
            if (warning){
                window.location.href="/login-page";
            }
        }

        goGeneral.forEach(button=>{
            button.addEventListener('click', leadToLogin);
        });*/

        /*const purpleBtn = document.querySelectorAll('.purple-button');
        purpleBtn.forEach(button=>{
            button.addEventListener('click', leadToLogin);
        })*/
        
  </script>
</footer>
</html>